@model IEnumerable<QuanLyPhongKham3.Models.Prescription>


@{ ViewBag.Title = "Index"; }


<table class="table" onload="JavaScript:timedRefresh(5000);">
    <tr>
        <th class="text-right">
            No.
        </th>
        <th>
            @Html.Label("Name")
        </th>
        <th>
            @Html.Label("Doctor Name")
        </th>
        <th>
            @Html.Label("Status")
        </th>
        <th>
            @Html.Label("Date of Create")
        </th>

        <th>



        </th>
    </tr>
    @{ int i = 0; }
    @foreach (var item in Model)
    {
<tr>
    <td class="text-right">
        @(++i)
    </td>

    <td>
        @Html.DisplayFor(modelItem => item.Customer.Name)
    </td>

    <td>
        @Html.DisplayFor(modelItem => item.Staff.Name)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Status)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.DateOfCreate)
    </td>

    <td type="button" class="btn btn-primary apply" data-id="@item.ID">
        <span class="glyphicon glyphicon-shopping-cart"></span> Apply
    </td>

</tr>}

</table>

@section Scripts{
    <script type="text/javascript">
        function timedRefresh(timeoutPeriod) {
            setTimeout(function () {
                location.reload(true);
            }, timeoutPeriod);
        }



        $(".apply").click(function () {
            var pres_id = $(this).data("id");
            //alert(pres_id)
            $.ajax({       
                url: '/DoctorCards/CheckScript',
                method: 'GET',
                async: true,
                cache: false,
                data: {
                    id: pres_id
                },
                beforeSend: function () {
                    alert("Waiting...");
                }
            }).done(function (result) {
                if (result.status == "OK") {
                    $("#total-amount").html(result.total_amount);
                    alert("Success!");
                }
                else if (result.status == "ER") {
                    //$("#fb").html(result.data);
                    alert("Error!", "Error!", result.data);
                }

            }).fail(function (xhr, status) {
                alert("danger", "Error!", status);
            }).always(function () {
                
            })
        })

    </script>

}
